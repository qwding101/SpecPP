<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing Lansing Woods data • SpecPP</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing Lansing Woods data">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SpecPP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lansing.html">Analyzing Lansing Woods data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/qwding101/SpecPP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analyzing Lansing Woods data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/qwding101/SpecPP/blob/master/vignettes/lansing.Rmd" class="external-link"><code>vignettes/lansing.Rmd</code></a></small>
      <div class="d-none name"><code>lansing.Rmd</code></div>
    </div>

    
    
<p>In this tutorial, we use the Lansing Woods dataset to demonstrate how
to extract frequency domain features from a multivariate inhomogeneous
point pattern data using SpecPP package. Here, we focus on the usage of
this package. For the interpretation of the result, please refer to Ding
et al. (2025, Section 3.2, Section 8, and Appendix F.3).</p>
<div class="section level2">
<h2 id="import-package-and-data">Import package and data<a class="anchor" aria-label="anchor" href="#import-package-and-data"></a>
</h2>
<p>The Lansing Woods dataset, available in the <code>spatstat</code>
package, contains the spatial distributions of six different tree
species.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/qwding101/SpecPP" class="external-link">SpecPP</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://spatstat.org/" class="external-link">spatstat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">lansing</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">.1</span>, main <span class="op">=</span> <span class="st">"Point pattern of Lansing Woods"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lansing_files/figure-html/setup-1.png" width="700"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lansing</span><span class="op">)</span></span>
<span><span class="co">#&gt; Marked planar point pattern:  2251 points</span></span>
<span><span class="co">#&gt; Average intensity 2251 points per square unit (one unit = 924 feet)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; *Pattern contains duplicated points*</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coordinates are given to 3 decimal places</span></span>
<span><span class="co">#&gt; i.e. rounded to the nearest multiple of 0.001 units (one unit = 924 feet)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multitype:</span></span>
<span><span class="co">#&gt;          frequency proportion intensity</span></span>
<span><span class="co">#&gt; blackoak       135 0.05997335       135</span></span>
<span><span class="co">#&gt; hickory        703 0.31230560       703</span></span>
<span><span class="co">#&gt; maple          514 0.22834300       514</span></span>
<span><span class="co">#&gt; misc           105 0.04664594       105</span></span>
<span><span class="co">#&gt; redoak         346 0.15370950       346</span></span>
<span><span class="co">#&gt; whiteoak       448 0.19902270       448</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Window: rectangle = [0, 1] x [0, 1] units</span></span>
<span><span class="co">#&gt; Window area = 1 square unit</span></span>
<span><span class="co">#&gt; Unit of length: 924 feet</span></span></code></pre></div>
<p>Before proceeding with the analysis, we first examine the side
lengths of the observational window. If the window is too small, the
spectral estimator will be evaluated on a coarse frequency grid,
limiting its ability to capture the frequency-domain characteristics of
the point pattern. By contrast, an excessively large window can make
computations unfeasible. We recommend side lengths between 20 and 40, as
they offer a good balance between computational efficiency and
resolution.</p>
<p>As shown in <code>summary(lansing)</code>, the window is the unit
square (since <a href="https://search.r-project.org/CRAN/refmans/spatstat.data/html/lansing.html" class="external-link"><code>spatstat</code></a>
rescaled the original window). This is too small for spectral analysis,
so we rescale it by a factor of 1/20:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scale.factor</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">20</span></span>
<span><span class="va">spp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="va">lansing</span>, <span class="va">scale.factor</span><span class="op">)</span></span></code></pre></div>
<p>Now the rescaled dataset <code>spp</code> with side lengths 20 is
suitable for our analysis.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/Window.html" class="external-link">Window</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span></span>
<span><span class="co">#&gt; window: rectangle = [0, 20] x [0, 20] units (one unit = 46.2 feet)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimate-pseudo-spectrum">Estimate pseudo-spectrum<a class="anchor" aria-label="anchor" href="#estimate-pseudo-spectrum"></a>
</h2>
<p>To estimate the pseudo-spectrum of <code>spp</code>, we use the
kernel spectral density estimator (KSDE). This calculation of KSDE
involves two key steps: intensity function estimation and bandwidth
selection.</p>
<div class="section level3">
<h3 id="intensity-function-estimation">Intensity function estimation<a class="anchor" aria-label="anchor" href="#intensity-function-estimation"></a>
</h3>
<p>The KSDE involves the first-order intensity function, which needs to
be estimated. While nonparametric approaches (e.g.,
<code>spatstat::density.ppp()</code>) are available, the asymptotic
properties of the KSDE are established under the parametric form of the
intensity. Therefore, for each tree species, we fit a log-linear model
for the intensity function using Cartesian coordinates:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span></span>
<span><span class="va">fit.lambda</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spps</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit.lambda</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spps</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">spps</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">fit.lambda</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.model/man/predict.ppm.html" class="external-link">predict.ppm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.model/man/ppm.html" class="external-link">ppm</a></span><span class="op">(</span><span class="va">spps</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span> <span class="op">+</span> <span class="va">x</span><span class="op">:</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We then plot the fitted intensity to verify whether it adequately
captures spatial inhomogeneity. The figure below suggests that our model
<code>~ x + y + x:y</code> may be overly simplistic. However, for
pedagogical purposes, we proceed with this specification.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/as.solist.html" class="external-link">as.solist</a></span><span class="op">(</span><span class="va">fit.lambda</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Estimated intensity"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lansing_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>In practice, additional spatial covariates can be incorporated to
improve the intensity model. These covariates should be specified in the
model formula and provided through the <code>data</code> argument in
<code><a href="https://rdrr.io/pkg/spatstat.model/man/ppm.html" class="external-link">spatstat.model::ppm()</a></code>. For example, if you have two
covariates <code>pH</code> and <code>gradient</code>, they should be
combined into a list and passed to the <code>data</code> argument (check
<code><a href="https://rdrr.io/pkg/spatstat.model/man/ppm.html" class="external-link">?spatstat.model::ppm</a></code> for details on the format of the
covariates):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Just an example. This dataset from spatstat doesn't have any covariate.</span></span>
<span><span class="va">covars</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pH</span>, <span class="va">gradient</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">spps</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">fit.lambda</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.model/man/predict.ppm.html" class="external-link">predict.ppm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.model/man/ppm.html" class="external-link">ppm</a></span><span class="op">(</span><span class="va">spps</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span> <span class="op">+</span> <span class="va">x</span><span class="op">:</span><span class="va">y</span> <span class="op">+</span> <span class="va">pH</span> <span class="op">+</span> <span class="va">gradient</span>,</span>
<span>                                    data <span class="op">=</span> <span class="va">covars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bandwidth-selection">Bandwidth selection<a class="anchor" aria-label="anchor" href="#bandwidth-selection"></a>
</h3>
<p>Selecting a good bandwidth is crucial for reliable spectral
estimation. This is handled by the <code><a href="../reference/select_band.html">select_band()</a></code> function,
which requires the following arguments:</p>
<ul>
<li>
<code>ppp</code>: The point pattern</li>
<li>
<code>inten.formula</code>: The model for the intensity (mentioned
in previous section), in our example, is <code>"~ x + y + x:y"</code>.
Note that the formula here must be provided as a string.</li>
<li>
<code>band.range</code>: A numeric vector defining the search space
for the optimal bandwidth.</li>
</ul>
<p>If additional spatial covariates are specified in
<code>inten.formula</code>, the corresponding data must be provided via
the <code>data.covariate</code> argument. Other arguments of
<code><a href="../reference/select_band.html">select_band()</a></code> can be left at their default values.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv</span> <span class="op">=</span> <span class="fu"><a href="../reference/select_band.html">select_band</a></span><span class="op">(</span>ppp <span class="op">=</span> <span class="va">spp</span>,</span>
<span>                 inten.formula <span class="op">=</span> <span class="st">"~ x + y + x:y"</span>,</span>
<span>                 band.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="fl">.01</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cv</span><span class="op">$</span><span class="va">Result</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, y <span class="op">=</span> <span class="va">cv</span><span class="op">$</span><span class="va">Result</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Bandwidth"</span>, ylab <span class="op">=</span> <span class="st">"Spectral divergence"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">cv</span><span class="op">$</span><span class="va">OptimalBandwidth</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lansing_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>As you see in above figure, the <code><a href="../reference/select_band.html">select_band()</a></code> calculates
the spectral divergence across all candidate bandwidths in
<code>band.range</code>. The bandwidth minimizing the spectral
divergence is the optimal bandwidth we select, which is
<code>cv$OptimalBandwidth</code> = 0.83 (marked by the blue dashed
line).</p>
<div class="section level4">
<h4 id="important-considerations-for-bandwidth-selection">
<em>Important considerations for bandwidth selection</em><a class="anchor" aria-label="anchor" href="#important-considerations-for-bandwidth-selection"></a>
</h4>
<ul>
<li><p><strong>Resolution of <code>band.range</code></strong>: The
search space should be neither too fine nor too coarse to balance the
computational efficiency with accuracy.</p></li>
<li><p><strong>Coverage of <code>band.range</code></strong>: A narrow
search range may fail to capture the global minimum. When the minimum
lies at the boundary of the specified range, <code><a href="../reference/select_band.html">select_band()</a></code>
issues a warning suggesting a broader search space. However, this
safeguard is not foolproof—there are cases where no warning appears even
if a local minimum is selected. For example, specifying
<code>band.range = seq(0.96, 1.05, 0.01)</code> in this example fails to
identify the global minimum, because the local minimum lies inside the
search range.</p></li>
</ul>
<p>To mitigate these risks, we recommend running
<code><a href="../reference/select_band.html">select_band()</a></code> multiple times with different
<code>band.range</code>, visualizing the results to ensure the chosen
bandwidth is robust and not constrained by an inadequate search
space.</p>
</div>
</div>
<div class="section level3">
<h3 id="calculate-the-ksde">Calculate the KSDE<a class="anchor" aria-label="anchor" href="#calculate-the-ksde"></a>
</h3>
<p>Finally, we can calculate the KSDE with the fitted intensity and
cross-validated bandwidth.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KSDE</span> <span class="op">=</span> <span class="fu"><a href="../reference/periodogram_smooth.html">periodogram_smooth</a></span><span class="op">(</span>ppp <span class="op">=</span> <span class="va">spp</span>,</span>
<span>                          inten.formula <span class="op">=</span> <span class="st">"~ x + y + x:y"</span>,</span>
<span>                          bandwidth <span class="op">=</span> <span class="va">cv</span><span class="op">$</span><span class="va">OptimalBandwidth</span><span class="op">)</span></span></code></pre></div>
<p>The output of <code><a href="../reference/periodogram_smooth.html">periodogram_smooth()</a></code> is a list of 6
(marginal) + 15 (cross) = 21 KSDE matrices.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">KSDE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "blackoak, blackoak" "blackoak, hickory"  "blackoak, maple"   </span></span>
<span><span class="co">#&gt;  [4] "blackoak, misc"     "blackoak, redoak"   "blackoak, whiteoak"</span></span>
<span><span class="co">#&gt;  [7] "hickory, hickory"   "hickory, maple"     "hickory, misc"     </span></span>
<span><span class="co">#&gt; [10] "hickory, redoak"    "hickory, whiteoak"  "maple, maple"      </span></span>
<span><span class="co">#&gt; [13] "maple, misc"        "maple, redoak"      "maple, whiteoak"   </span></span>
<span><span class="co">#&gt; [16] "misc, misc"         "misc, redoak"       "misc, whiteoak"    </span></span>
<span><span class="co">#&gt; [19] "redoak, redoak"     "redoak, whiteoak"   "whiteoak, whiteoak"</span></span></code></pre></div>
<p>Note that the KSDE for cross pseudo-spectrum is complex-valued. We
need to visualize the real and imaginary parts separately. By default,
<code><a href="../reference/plot_pairs.html">plot_pairs()</a></code> plot the real part of the radially averaged
spectral estimate:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_pairs.html">plot_pairs</a></span><span class="op">(</span>est.list <span class="op">=</span> <span class="va">KSDE</span>, ppp <span class="op">=</span> <span class="va">spp</span><span class="op">)</span></span></code></pre></div>
<p><img src="lansing_files/figure-html/unnamed-chunk-10-1.png" width="864"></p>
<p>To examine the imaginary part, we set <code>type = "Im"</code>. As
below figure shows, the values are almost zero, particularly for
marginal cases where they should be exactly zero. Thus, the real part is
our primary focus of analysis.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_pairs.html">plot_pairs</a></span><span class="op">(</span>est.list <span class="op">=</span> <span class="va">KSDE</span>, ppp <span class="op">=</span> <span class="va">spp</span>, type <span class="op">=</span> <span class="st">"Im"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lansing_files/figure-html/unnamed-chunk-11-1.png" width="864"></p>
</div>
</div>
<div class="section level2">
<h2 id="coherence-analysis">Coherence analysis<a class="anchor" aria-label="anchor" href="#coherence-analysis"></a>
</h2>
<p>Similar to spectral analysis in time series, we can calculate the
coherence and partial coherence based on the pseudo-spectrum for point
processes. The <code><a href="../reference/coherence.html">coherence()</a></code> function computes these measures
for all non-overlaping frequencies and extracts their maxima. By default
(<code>type = "partial"</code>), it returns the maximal partial
coherence between any two point processes. In the code below, we
calculate the maximal coherence and partial coherence for all pairwise
point processes.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coh.partial</span> <span class="op">=</span> <span class="fu"><a href="../reference/coherence.html">coherence</a></span><span class="op">(</span>sp.est <span class="op">=</span> <span class="va">KSDE</span>, ppp <span class="op">=</span> <span class="va">spp</span><span class="op">)</span> <span class="co"># Maximal partial coherence</span></span>
<span><span class="co">#&gt; Number of frequencies to pick the maximum partial coherence: 25 (this value should not be too small).</span></span>
<span><span class="va">coh</span> <span class="op">=</span> <span class="fu"><a href="../reference/coherence.html">coherence</a></span><span class="op">(</span>sp.est <span class="op">=</span> <span class="va">KSDE</span>, ppp <span class="op">=</span> <span class="va">spp</span>, type <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span> <span class="co"># Maximal coherence</span></span>
<span><span class="co">#&gt; Number of frequencies to pick the maximum coherence: 25 (this value should not be too small).</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">coh.partial</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;          blackoak hickory maple misc redoak whiteoak</span></span>
<span><span class="co">#&gt; blackoak     1.00    0.85  0.96 0.98   0.96     0.96</span></span>
<span><span class="co">#&gt; hickory      0.85    1.00  0.88 0.88   0.86     0.86</span></span>
<span><span class="co">#&gt; maple        0.96    0.88  1.00 0.99   0.96     0.98</span></span>
<span><span class="co">#&gt; misc         0.98    0.88  0.99 1.00   0.98     0.98</span></span>
<span><span class="co">#&gt; redoak       0.96    0.86  0.96 0.98   1.00     0.96</span></span>
<span><span class="co">#&gt; whiteoak     0.96    0.86  0.98 0.98   0.96     1.00</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">coh</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;          blackoak hickory maple misc redoak whiteoak</span></span>
<span><span class="co">#&gt; blackoak     1.00    0.10  0.17 0.54   0.20     0.20</span></span>
<span><span class="co">#&gt; hickory      0.10    1.00  0.31 0.13   0.05     0.05</span></span>
<span><span class="co">#&gt; maple        0.17    0.31  1.00 0.64   0.38     0.33</span></span>
<span><span class="co">#&gt; misc         0.54    0.13  0.64 1.00   0.70     0.35</span></span>
<span><span class="co">#&gt; redoak       0.20    0.05  0.38 0.70   1.00     0.21</span></span>
<span><span class="co">#&gt; whiteoak     0.20    0.05  0.33 0.35   0.21     1.00</span></span></code></pre></div>
<p>Instead of summarizing by a single value, the
<code><a href="../reference/plot_coher.html">plot_coher()</a></code> function allows us to visualize the coherence
and partial coherence values across all non-overlapping frequencies.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_coher.html">plot_coher</a></span><span class="op">(</span>sp.est <span class="op">=</span> <span class="va">KSDE</span>,</span>
<span>           coh.mat <span class="op">=</span> <span class="va">coh</span>,</span>
<span>           partial.coh.mat <span class="op">=</span> <span class="va">coh.partial</span>,</span>
<span>           ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lansing_files/figure-html/unnamed-chunk-13-1.png" width="864"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Qi-Wen Ding.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
